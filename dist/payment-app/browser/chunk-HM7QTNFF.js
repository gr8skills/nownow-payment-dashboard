import{a as Kt,b as Z}from"./chunk-7I64ZNS7.js";import{h as kt}from"./chunk-6OFH25Z4.js";import{a as At}from"./chunk-3SHQUS67.js";import{a as jt}from"./chunk-METUFYIJ.js";import{a as Rt}from"./chunk-FL4KNXRL.js";import"./chunk-KMXAENHX.js";import{a as Bt}from"./chunk-S2LAGHCE.js";import"./chunk-BLRPO3V7.js";import{A as j,a as Ft,c as It,e as B,g as Tt,h as L,i as St,j as R,l as K,n as Dt,o as Nt,p as Et,r as Mt,x as Pt}from"./chunk-42IJ7B5N.js";import{b as Lt,c as S}from"./chunk-CU2GO6I3.js";import"./chunk-4J7Y23TQ.js";import{b as bt,d as Ot,e as Vt}from"./chunk-FLUB3X5H.js";import{b as xt}from"./chunk-SBLTLQWW.js";import"./chunk-JRKGGQZY.js";import{i as dt,j as gt,k as yt,l as Ct,m as _t,n as vt,r as wt}from"./chunk-FV7KSPUE.js";import{Ab as y,Bb as rt,Cb as st,Db as at,Eb as O,Ib as v,Jb as a,Pa as it,Q as J,Rb as lt,Sa as m,Sb as ct,T as X,U as Y,V as E,Vb as pt,Wb as U,X as $,Xa as G,Xb as w,Z as f,Zb as P,ca as d,cb as _,cc as k,da as g,db as M,dc as A,ec as ut,f as N,fc as V,ga as tt,ha as et,hb as b,jb as ot,kb as H,ma as x,oc as ft,ra as nt,sb as I,tb as T,tc as mt,vc as ht,xb as c,yb as p,zb as h}from"./chunk-JFWELGSQ.js";import{a as q}from"./chunk-2NFLSA4Y.js";var Qt=o=>({"error-input":o});function Wt(o,r){if(o&1&&(p(0,"span"),w(1),h()),o&2){let i=a(3);m(),P(" ",i.config.separator," ")}}function Jt(o,r){if(o&1){let i=O();rt(0),p(1,"input",5,0),v("paste",function(n){d(i);let e=a(2);return g(e.handlePaste(n))})("keyup",function(n){let e=d(i).index,s=a(2);return g(s.onKeyUp(n,e))})("input",function(n){let e=d(i).index,s=a(2);return g(s.onInput(n,e))})("keydown",function(n){let e=d(i).index,s=a(2);return g(s.onKeyDown(n,e))}),h(),b(3,Wt,2,1,"span",6),st()}if(o&2){let i=r.$implicit,t=r.index,n=r.last,e=a(2);m(),U(k("otp-input ",e.config.inputClass)),c("pattern",e.config.allowNumbersOnly?"\\d*":"")("type",e.inputType)("placeholder",(e.config==null?null:e.config.placeholder)||"")("ngStyle",e.config.inputStyles)("formControl",e.otpForm.controls[i])("id",e.getBoxId(t))("ngClass",V(11,Qt,(e.config==null?null:e.config.showError)&&(e.formControl==null?null:e.formControl.invalid)&&((e.formControl==null?null:e.formControl.dirty)||(e.formControl==null?null:e.formControl.touched)))),m(2),c("ngIf",e.config.separator&&!n)}}function Xt(o,r){if(o&1){let i=O();p(0,"div",2),v("focusin",function(){d(i);let n=a();return g(n.onFocusIn())})("focusout",function(){d(i);let n=a();return g(n.onFocusOut())}),p(1,"div",3),b(2,Jt,4,13,"ng-container",4),h()()}if(o&2){let i=a();U(k("ng-otp-input-wrapper wrapper ",i.config.containerClass)),c("id",k("c_",i.componentKey))("ngStyle",i.config.containerStyles),m(2),c("ngForOf",i.controlKeys)}}var C=class{static ifTab(r){return this.ifKey(r,"Tab")}static ifDelete(r){return this.ifKey(r,"Delete;Del")}static ifBackspace(r){return this.ifKey(r,"Backspace")}static ifRightArrow(r){return this.ifKey(r,"ArrowRight;Right")}static ifLeftArrow(r){return this.ifKey(r,"ArrowLeft;Left")}static ifSpacebar(r){return this.ifKey(r,"Spacebar; ")}static ifKey(r,i){return i.split(";").some(n=>n===r.key)}},D=class{static keys(r){return r?Object.keys(r):[]}},W=(()=>{let r=class r{set disabled(t){this.setDisabledState(t)}get inputType(){return this.config?.isPasswordInput?"password":this.config?.allowNumbersOnly?"tel":"text"}get controlKeys(){return D.keys(this.otpForm?.controls)}get formControl(){return this.formCtrl??this.inj?.get(Tt)}constructor(t,n){this.document=t,this.inj=n,this.config={length:4},this.onBlur=new N,this.onInputChange=new N,this.inputControls=new Array(this.config.length),this.componentKey=Math.random().toString(36).substring(2)+new Date().getTime().toString(36),this.destroy$=new N,this.activeFocusCount=0,this.onChange=()=>{},this.onTouched=()=>{},this._isDisabled=!1}ngOnInit(){this.otpForm=new R({});for(let t=0;t<this.config.length;t++)this.otpForm.addControl(this.getControlName(t),new K);this.otpForm.valueChanges.pipe(J(this.destroy$)).subscribe(t=>{D.keys(this.otpForm.controls).forEach(n=>{var e=this.otpForm.controls[n].value;e&&e.length>1&&(e.length>=this.config.length?this.setValue(e):this.rebuildValue())})})}setDisabledState(t){this._isDisabled=t,this.otpForm&&(t?this.otpForm.disable({emitEvent:!1}):this.otpForm.enable({emitEvent:!1}))}writeValue(t){this.currentVal=this.hasVal(t)?t:null,this.setValue(this.currentVal)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}onFocusIn(){this.onTouched(),this.activeFocusCount++}onFocusOut(){setTimeout(()=>{this.activeFocusCount--,this.activeFocusCount===0&&(this.onTouched(),this.onBlur.next())},0)}ngAfterViewInit(){if(!this.config.disableAutoFocus){let t=this.document.getElementById(`c_${this.componentKey}`);if(t){let n=t.getElementsByClassName("otp-input")[0];n&&n.focus&&n.focus()}}}getControlName(t){return`ctrl_${t}`}onKeyDown(t,n){let e=this.getBoxId(n-1),s=this.getBoxId(n);if(C.ifKey(t,"Enter")){let F=this.document.getElementById(s)?.closest("form");if(F){t.preventDefault(),F.dispatchEvent(new Event("submit"));return}}if(C.ifSpacebar(t))return t.preventDefault(),!1;if(C.ifBackspace(t)){t.target.value?this.clearInput(s,n):(this.clearInput(e,n-1),this.setSelected(e)),this.rebuildValue();return}if(C.ifDelete(t)){t.target.value?this.clearInput(s,n):(this.clearInput(e,n-1),this.setSelected(e)),this.rebuildValue();return}}hasVal(t){return t!=null&&t!=null&&(!t?.trim||t.trim()!="")}onInput(t,n){let e=this.hasVal(this.currentVal)?`${this.currentVal}${t.target.value}`:t.target.value;if(this.config.allowNumbersOnly&&!this.validateNumber(e)){t.target.value=null,t.stopPropagation(),t.preventDefault(),this.clearInput(null,n);return}if(this.ifValidKeyCode(null,t.target.value)){let s=this.getBoxId(n+1);this.setSelected(s),this.rebuildValue()}else{t.target.value=null;let s=this.getControlName(n);this.otpForm.controls[s]?.setValue(null),this.rebuildValue()}}onKeyUp(t,n){C.ifTab(t)&&(n-=1);let e=this.getBoxId(n+1),s=this.getBoxId(n-1);if(C.ifRightArrow(t)){t.preventDefault(),this.setSelected(e);return}if(C.ifLeftArrow(t)){t.preventDefault(),this.setSelected(s);return}}validateNumber(t){return t&&/^[0-9]+$/.test(t)}getBoxId(t){return`otp_${t}_${this.componentKey}`}clearInput(t,n){let e=this.getControlName(n);if(this.otpForm.controls[e]?.setValue(null),t){let s=this.document.getElementById(t);s&&s instanceof HTMLInputElement&&(s.value=null)}}setSelected(t){this.focusTo(t);let n=this.document.getElementById(t);n&&n.setSelectionRange&&setTimeout(()=>{n.setSelectionRange(0,1)},0)}ifValidKeyCode(t,n){let e=n??t.key;return this.config?.allowNumbersOnly?this.validateNumber(e):/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||/^[a-zA-Z0-9%*_\-@#$!]$/.test(e)&&e.length==1}focusTo(t){let n=this.document.getElementById(t);n&&n.focus()}setValue(t){if(!(this.config.allowNumbersOnly&&isNaN(t))){if(this.otpForm?.reset(),!this.hasVal(t)){this.rebuildValue();return}t=t.toString().replace(/\s/g,""),Array.from(t).forEach((n,e)=>{this.otpForm.get(this.getControlName(e))&&this.otpForm.get(this.getControlName(e)).setValue(n)}),this.config.disableAutoFocus||setTimeout(()=>{let n=this.document.getElementById(`c_${this.componentKey}`);var e=t.length<this.config.length?t.length:this.config.length-1;let s=n.getElementsByClassName("otp-input")[e];s&&s.focus&&setTimeout(()=>{s.focus()},1)},0),this.rebuildValue()}}rebuildValue(){let t=null;D.keys(this.otpForm.controls).forEach(n=>{let e=this.otpForm.controls[n].value;if(e){let s=e.length>1,l=!this.config.allowNumbersOnly&&this.config.letterCase&&(this.config.letterCase.toLocaleLowerCase()=="upper"||this.config.letterCase.toLocaleLowerCase()=="lower");e=e[0];let F=l?this.config.letterCase.toLocaleLowerCase()=="upper"?e.toUpperCase():e.toLowerCase():e;l&&F==e?l=!1:e=F,t==null?t=e:t+=e,(s||l)&&this.otpForm.controls[n].setValue(e)}}),this.currentVal!=t&&(this.currentVal=t,this.onChange(t),this.formCtrl?.setValue&&this.formCtrl.setValue(t),this.onInputChange.next(t))}handlePaste(t){let n=t.clipboardData||window.clipboardData;if(n)var e=n.getData("Text");t.stopPropagation(),t.preventDefault(),!(!e||this.config.allowNumbersOnly&&!this.validateNumber(e))&&this.setValue(e)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};r.\u0275fac=function(n){return new(n||r)(G(et),G(tt))},r.\u0275cmp=_({type:r,selectors:[["ng-otp-input"],["ngx-otp-input"]],inputs:{config:"config",formCtrl:"formCtrl",disabled:"disabled"},outputs:{onBlur:"onBlur",onInputChange:"onInputChange"},features:[A([{provide:Ft,useExisting:X(()=>r),multi:!0}])],decls:1,vars:1,consts:[["inp",""],["tabindex","0",3,"class","id","ngStyle","focusin","focusout",4,"ngIf"],["tabindex","0",3,"focusin","focusout","id","ngStyle"],[1,"n-o-c"],[4,"ngFor","ngForOf"],["autocomplete","one-time-code",3,"paste","keyup","input","keydown","pattern","type","placeholder","ngStyle","formControl","id","ngClass"],[4,"ngIf"]],template:function(n,e){n&1&&b(0,Xt,3,7,"div",1),n&2&&c("ngIf",e.otpForm==null?null:e.otpForm.controls)},dependencies:[j,It,L,Pt,Nt,Ct,yt,_t,gt],styles:[".otp-input[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:4px;border:solid 1px #c5c5c5;text-align:center;font-size:32px}.ng-otp-input-wrapper[_ngcontent-%COMP%]   .otp-input[_ngcontent-%COMP%]{margin:0 .51rem}.ng-otp-input-wrapper[_ngcontent-%COMP%]   .otp-input[_ngcontent-%COMP%]:first-child{margin-left:0}.ng-otp-input-wrapper[_ngcontent-%COMP%]   .otp-input[_ngcontent-%COMP%]:last-child{margin-right:0}.n-o-c[_ngcontent-%COMP%]{display:flex;align-items:center}.error-input[_ngcontent-%COMP%]{border-color:red}@media screen and (max-width: 767px){.otp-input[_ngcontent-%COMP%]{width:40px;font-size:24px;height:40px}}@media screen and (max-width: 420px){.otp-input[_ngcontent-%COMP%]{width:30px;font-size:18px;height:30px}}"]});let o=r;return o})(),zt=(()=>{let r=class r{};r.\u0275fac=function(n){return new(n||r)},r.\u0275mod=M({type:r}),r.\u0275inj=E({imports:[W]});let o=r;return o})();var $t=o=>({$implicit:o});function te(o,r){o&1&&at(0)}function ee(o,r){if(o&1&&b(0,te,1,0,"ng-container",1),o&2){let i=a();c("ngTemplateOutlet",i.render)("ngTemplateOutletContext",V(2,$t,i.i))}}function ne(o,r){if(o&1&&y(0,"span",0),o&2){let i=a();c("innerHTML",i.i.text,it)}}var u=function(o){return o[o.ing=0]="ing",o[o.pause=1]="pause",o[o.stop=2]="stop",o[o.done=3]="done",o}(u||{}),qt=(()=>{class o{ngZone=f(H);fns=[];commands=[];nextTime=0;ing=!1;start(){this.ing!==!0&&(this.ing=!0,this.nextTime=+new Date,this.ngZone.runOutsideAngular(()=>{this.process()}))}process(){for(;this.commands.length;)this.commands.shift()();let i=+new Date-this.nextTime,t=1+Math.floor(i/100);i=100-i%100,this.nextTime+=100*t;for(let n=0,e=this.fns.length;n<e;n+=2){let s=this.fns[n+1];if(s===0)this.fns[n](t);else{s+=2*t-1;let l=Math.floor(s/20);l>0&&this.fns[n](l),this.fns[n+1]=s%20+1}}this.ing&&setTimeout(()=>this.process(),i)}add(i,t){return this.commands.push(()=>{this.fns.push(i),this.fns.push(t===1e3?1:0),this.ing=!0}),this}remove(i){return this.commands.push(()=>{let t=this.fns.indexOf(i);t!==-1&&this.fns.splice(t,2),this.ing=this.fns.length>0}),this}static \u0275fac=function(t){return new(t||o)};static \u0275prov=Y({token:o,factory:o.\u0275fac})}return o})(),ie=new $("COUNTDOWN_CONFIG");var Gt=(()=>{class o{locale=f(ft);timer=f(qt);cdr=f(ht);ngZone=f(H);defCog=f(ie,{optional:!0});frequency=1e3;_notify={};status=u.ing;isDestroy=!1;_config;i={};left=0;set config(i){i.notify!=null&&!Array.isArray(i.notify)&&i.notify>0&&(i.notify=[i.notify]),this._config=i}get config(){return this._config}render;event=new ot;begin(){this.status=u.ing,this.callEvent("start")}restart(){this.status!==u.stop&&this.destroy(),this.init(),this.callEvent("restart")}stop(){this.status!==u.stop&&(this.status=u.stop,this.destroy(),this.callEvent("stop"))}pause(){this.status===u.stop||this.status===u.pause||(this.status=u.pause,this.callEvent("pause"))}resume(){this.status===u.stop||this.status!==u.pause||(this.status=u.ing,this.callEvent("resume"))}callEvent(i){this.event.emit({action:i,left:this.left,status:this.status,text:this.i.text})}init(){let i=this.config=q(q({demand:!1,leftTime:0,format:"HH:mm:ss",timezone:"+0000",formatDate:({date:e,formatStr:s,timezone:l})=>dt(new Date(e),s,this.locale,l||"+0000")},this.defCog),this.config),t=this.frequency=~i.format.indexOf("S")?100:1e3;this.status=i.demand?u.pause:u.ing,this.getLeft();let n=this.reflow;this.reflow=(e=0,s=!1)=>n.apply(this,[e,s]),Array.isArray(i.notify)&&i.notify.forEach(e=>{if(e<1)throw new Error("The notify config must be a positive integer.");e=e*1e3,e=e-e%t,this._notify[e]=!0}),this.timer.add(this.reflow,t).start(),this.reflow(0,!0)}destroy(){return this.timer.remove(this.reflow),this}reflow(i=0,t=!1){if(this.isDestroy)return;let{status:n,config:e,_notify:s}=this;if(!t&&n!==u.ing)return;let l=this.left=this.left-this.frequency*i;l<1&&(l=0),this.i={value:l,text:e.formatDate({date:l,formatStr:e.format,timezone:e.timezone})},typeof e.prettyText=="function"&&(this.i.text=e.prettyText(this.i.text)),this.cdr.detectChanges(),(e.notify===0||s[l])&&this.ngZone.run(()=>{this.callEvent("notify")}),l===0&&this.ngZone.run(()=>{this.status=u.done,this.destroy(),this.callEvent("done")})}getLeft(){let{config:i,frequency:t}=this,n=i.leftTime*1e3,e=i.stopTime;!n&&e&&(n=e-new Date().getTime()),this.left=n-n%t}ngOnInit(){this.init(),this.config.demand||this.begin()}ngOnDestroy(){this.isDestroy=!0,this.destroy()}ngOnChanges(i){i.config.firstChange||this.restart()}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=_({type:o,selectors:[["countdown"]],hostVars:2,hostBindings:function(t,n){t&2&&pt("count-down",!0)},inputs:{config:"config",render:"render"},outputs:{event:"event"},features:[A([qt]),nt],decls:2,vars:1,consts:[[3,"innerHTML"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,n){t&1&&I(0,ee,1,4,"ng-container")(1,ne,1,1,"span",0),t&2&&T(n.render?0:1)},dependencies:[vt],styles:[`.count-down{font-variant-numeric:tabular-nums}
`],encapsulation:2,changeDetection:0})}return o})(),Ht=(()=>{class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=M({type:o});static \u0275inj=E({})}return o})();var se=["cd"],ae=o=>[o],le=()=>({length:6,showError:!0,inputClass:"!text-3xl md:!text-4xl !w-14 !h-14 md:!w-16 md:!h-16 !bg-white focus:!outline-gray-200"});function ce(o,r){if(o&1){let i=O();p(0,"div",8),w(1," Otp will expire in "),p(2,"countdown",12,0),v("event",function(n){d(i);let e=a();return g(e.handleEvent(n))}),h()()}if(o&2){let i=a();m(2),c("config",i.config)}}function pe(o,r){if(o&1){let i=O();p(0,"span",13),v("click",function(){d(i);let n=a();return g(n.resendOtp())}),w(1,"Resend OTP"),h()}}function ue(o,r){if(o&1&&y(0,"app-error-message",10),o&2){let i=a();c("message",i.message())}}var z=class o{authService=f(Lt);router=f(Ot);route=f(bt);snackBar=f(Rt);phone=this.route.snapshot.queryParams.phone;AppPaths=S;AuthPaths=jt;hide=x(!0);loading=x(!1);message=x("");showPassword=x(!1);showCountDown=x(!1);countdown=mt("cd");config={leftTime:300,format:"mm:ss"};subs=new Bt;ngOnDestroy(){this.subs.unSubscribe()}togglePasswordVisibility(){this.showPassword.set(!this.showPassword())}clickEvent(r){this.hide.set(!this.hide()),r.stopPropagation()}companyOtpForm=new R({otp:new K("",{validators:[B.required,B.minLength(6),B.maxLength(6)]})});get otp(){return this.companyOtpForm.get("otp")}resendOtp(){this.subs.add=this.authService.sendOtp(this.phone).subscribe({next:r=>{this.showCountDown.set(!0),this.countdown()?.begin(),this.loading.set(!1),r.mfsCommonServiceResponse.mfsStatusInfo.status.includes("Failure")&&(this.snackBar.open(r.mfsCommonServiceResponse.mfsStatusInfo.errorDescription,"close",Z),this.message.set(r.mfsCommonServiceResponse.mfsStatusInfo.errorDescription))},error:r=>{this.loading.set(!1),this.message.set(r?.error?.message)}})}handleEvent(r){console.log(r),r.left===0&&this.showCountDown.set(!1)}onSubmit(){this.companyOtpForm.invalid||(this.loading.set(!0),this.subs.add=this.authService.verifyOtp(this.otp?.value).subscribe({next:r=>{this.loading.set(!1),r.mfsCommonServiceResponse.mfsStatusInfo.status.includes("Failure")?(this.snackBar.open(r.mfsCommonServiceResponse.mfsStatusInfo.errorDescription,"close",Z),this.message.set(r.mfsCommonServiceResponse.mfsStatusInfo.errorDescription)):this.router.navigate([S.account])},error:r=>{this.loading.set(!1),this.message.set(r?.error?.message)}}))}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=_({type:o,selectors:[["app-verify-otp-form"]],viewQuery:function(i,t){i&1&&lt(t.countdown,se,5),i&2&&ct()},decls:14,vars:11,consts:[["cd",""],["ngSrc","/icons/United Softwares Logo.svg","alt","United Softwares logo","width","240","height","40","priority","",1,"w-26","h-10","object-contain","mx-auto",3,"routerLink"],[1,"mb-6"],[1,"text-2xl","font-semibold","text-gray-800","mb-2"],[1,"text-gray-600","text-sm"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-y-5"],["formControlName","otp",3,"config"],[1,"w-max","mx-auto","inline-block","py-1","px-4","bg-blue-100","text-sm","text-gray-600","rounded"],[1,"underline","cursor-pointer"],[3,"message"],["type","submit","text","Verify My Account",3,"loading","disabled"],[3,"event","config"],[1,"underline","cursor-pointer",3,"click"]],template:function(i,t){i&1&&(y(0,"img",1),p(1,"div",2)(2,"h1",3),w(3,"Enter OTP"),h(),p(4,"p",4),w(5),h()(),p(6,"form",5),v("ngSubmit",function(){return t.onSubmit()}),p(7,"div",6),y(8,"ng-otp-input",7),I(9,ce,4,1,"div",8)(10,pe,2,0,"span",9),I(11,ue,1,1,"app-error-message",10),p(12,"div"),y(13,"app-button",11),h()()()),i&2&&(c("routerLink",V(8,ae,t.AppPaths.home)),m(5),P("We sent a OTP to your phone number ",t.phone,"."),m(),c("formGroup",t.companyOtpForm),m(2),c("config",ut(10,le)),m(),T(t.showCountDown()?9:10),m(2),T(t.message()&&!t.loading()?11:-1),m(2),c("loading",t.loading())("disabled",t.companyOtpForm.invalid||t.loading()))},dependencies:[j,Dt,L,St,Et,Mt,At,kt,Kt,zt,W,wt,Vt,Ht,Gt],encapsulation:2,changeDetection:0})};var Ut=class o{title=f(xt);AppPaths=S;ngOnInit(){this.title.setTitle("Verify OTP")}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=_({type:o,selectors:[["app-verify-otp"]],decls:5,vars:0,consts:[[1,"relative","grid","md:grid-cols-2","h-screen"],[1,"flex","flex-col","justify-center","p-3","md:pl-[10%]"],[1,"max-w-lg"],["id","verify-bg",1,"hidden","md:block","bg-gray-400"]],template:function(i,t){i&1&&(p(0,"div",0)(1,"div",1)(2,"div",2),y(3,"app-verify-otp-form"),h()(),y(4,"div",3),h())},dependencies:[z],styles:["#verify-bg[_ngcontent-%COMP%]{background-image:url(/media/pos.jpg);background-size:cover;background-position:center;background-repeat:no-repeat}"]})};export{Ut as VerifyOtpComponent};
